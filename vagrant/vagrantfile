Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/xenial64"
  config.vm.network "forwarded_port", guest: 8080, host: 80
  config.vm.provider "virtualbox" do |vb|
     vb.memory = "1024"
  end
  config.vm.provision "shell", inline: <<-SHELL
    sudo apt-get update
    echo "[*] Cheking jenkins.........."
    if [ ! -d ~/jenkins ]; then
      echo "[!] Jenkins is not installed.........."
      echo "[*] Installing dependencies..........."
      sudo apt-get install -y nano git
      echo "[*] Installing java..................."
      sudo apt-get install -y software-properties-common debconf-utils
      sudo add-apt-repository -y ppa:webupd8team/java
      sudo apt-get update
      echo "oracle-java8-installer shared/accepted-oracle-license-v1-1 select true" | sudo debconf-set-selections
      sudo apt-get install -y oracle-java8-installer
      echo "Downloading jenkins..............."
      mkdir ~/jenkins
      wget http://mirrors.jenkins.io/war-stable/latest/jenkins.war -P ~/jenkins
      echo "Jenkins downloaded successfully..............."
      echo "Granting permissions.........................."
      chmod 777 ~/jenkins/jenkins.war
    fi
    echo "Excecuting jenkins....................."
    echo "The initial code is on this terminal..."
    java -jar ~/jenkins/jenkins.war
  SHELL
end
